.MODEL SMALL

.STACK 100H

.DATA

NUM1 DB 200 ; BALANCE

NUM2 DB 123 ; CORRECT PIN

MSG3 DB '$'

MSG4 DB '** PLEASE TRY AGAIN$'

MSG5 DB '** ENTER PIN: $'

MSG6 DB '** WITHDRAW? (1-YES, 0-NO): $'

MSG7 DB '** ENTER AMOUNT: $'

MSG8 DB '** SELECT OPTION (1-BALANCE, 2-WITHDRAW, 3-EXIT): $'

MSG9 DB '** ACCOUNT BALANCE: P$'

MSG10 DB '** CASH WITHDRAWN: P$'

MSG11 DB '*********************************************************$'

MSG12 DB '** ****** 8086 ATM ****** **$'

MSG13 DB '** **$'

MSG DB 'EXITING...'

.CODE

MAIN PROC

MOV AX,@DATA

MOV DS,AX

MOV CL,3 ; ATTEMPT COUNTER

MOV BL,NUM2 ; CORRECT PIN

PIN:

LEA DX,MSG5

MOV AH,9

INT 21H ; 'ENTER PIN: '

MOV AH,1

INT 21H ; INPUT PIN

INT 21H

INT 21H

MOV BH,AL

;SUB BH,48

CMP BH,BL ; VERIFY PIN

JE WITHDRAW?

DEC CL ; COUNT ATTEMPTS

CMP CL,0

JE EXIT_P

LEA DX,MSG4

MOV AH,9

INT 21H ; 'PLEASE TRY AGAIN'

JNE PIN

WITHDRAW?:

LEA DX,MSG6

MOV AH,9

INT 21H ; 'WITHDRAW?'

MOV AH,1

INT 21H ; INPUT WITHDRAW?

MOV BH,AL

;SUB BH,48

CMP BH,1

JE WITHDRAW

OPTION:

LEA DX,MSG8

MOV AH,9

INT 21H ; 'SELECT OPTION: '

MOV AH,1

INT 21H ; INPUT OPTION

MOV BH,AL

;SUB BH,48

CMP BH,1

JE BALANCE

CMP BH,2

JE WITHDRAW

JMP EXIT_P

BALANCE:

LEA DX,MSG9

MOV AH,9

INT 21H ; 'ACCOUNT BALANCE: '

LEA DX,NUM1 ; BALANCE

MOV AH,9

INT 21H ; PRINT BALANCE

JMP OPTION

WITHDRAW:

LEA DX,MSG7

MOV AH,9

INT 21H ; 'ENTER AMOUNT: '

MOV AH,1

INT 21H ; INPUT AMOUNT

INT 21H

INT 21H

MOV BH,AL

;SUB BH,48

MOV BL,NUM1 ; BALANCE

MOV CL,BL ; LOOP COUNTER

SUB BL,BH ; SUBTRACT AMOUNT

CMP BL,0 ; INITIAL CHECKING

JE RECEIPT

NEGATIVE:

DEC BL

CMP BL,0

JE RECEIPT ; IF AMOUNT IS VALID

DEC CL

CMP CL,0

JNE NEGATIVE ; IF BALANCE IS NEGATIVE

LEA DX,MSG4

MOV AH,9

INT 21H ; 'PLEASE TRY AGAIN'

JE WITHDRAW

RECEIPT:

MOV BL,NUM1 ; BALANCE

SUB BL,BH ; SUBTRACT AMOUNT AGAIN

MOV NUM1,BL ; UPDATE BALANCE

LEA DX,MSG9

MOV AH,9

INT 21H ; 'ACCOUNT BALANCE: '

LEA DX,NUM1 ; BALANCE

MOV AH,9

INT 21H ; PRINT BALANCE

LEA DX,MSG10

MOV AH,9

INT 21H ; 'CASH WITHDRAWN: '

LEA DX,NUM1 ; AMOUNT

MOV AH,9

INT 21H ; PRINT AMOUNT

EXIT_P:

LEA DX,MSG

MOV AH,9

INT 21H ; 'EXITING...'

EXIT:

MOV AH,4CH

INT 21H

MAIN ENDP

END MAIN